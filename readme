cleaned up code for DOI:10.1039/C8SC03077D
